/*!
 * nbb-anime-statistics - v0.0.3 - 2018-01-25
 * Copyright (c) 2018 Lu√≠s Nabais <dextro@nonsensebb.com>
 * Licensed MIT
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.index=t():e.index=t()}("undefined"!=typeof self?self:this,function(){return webpackJsonp_object_Object_([2],{174:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){u()}function u(){var e=l();C.default.all(e.map(o)).then(function(e){console.debug("Genre data",e),p(e),v(e),y(e)}),C.default.all(e.map(i)).then(function(e){console.debug("Episode Count per Genre Data",e),b(e)})}function l(){var e=I.querySelectorAll(":checked"),t=Z.querySelectorAll(":checked");return e=Array.prototype.slice.call(e),t=Array.prototype.slice.call(t),e.concat(t).map(function(e){return{key:e.value,color:e.dataset.color}})}function o(e){return D.default.DB.getData(e.key).then(function(e){return c(e&&e.rows)}).then(D.default.buildEntry(e))}function i(e){return D.default.DB.getEpisodeData(e.key).then(function(e){return d(e&&e.rows)}).then(f).then(function(t){return(0,x.default)(t).reduce(function(n,a){return n[a]=D.default.buildEntry(e)(t[a]),n},{})})}function c(e){var t=[].concat(e||[]).reduce(function(e,t){return e[t.key[1]]=t.value,e},{});return D.default.mapToActiveYears(t)}function d(e){var t=[].concat(e||[]).reduce(function(e,t){var n=t.key[2],a=t.key[1];return e[a]=e[a]||{},e[a][n]=t.value,e},{});return D.default.reduceToActiveYears(t)}function f(e){return(0,x.default)(e).reduce(function(t,n){return t[n]=s(e[n]||[]),t},{})}function s(e){return e.map(function(e){return Math.round(e.sum/e.count||0)})}function p(e){q.absolute&&q.absolute.destroy();var t=e,n={scaleLabel:{display:!0,labelString:"count"},ticks:{beginAtZero:!0}},a=D.default.getTotals();t=[{label:"total",data:(0,x.default)(a).map(function(e){return a[e]}),fill:!1}].concat(t||[]),q.absolute=D.default.drawLineChart(j,t,n)}function v(e){q.relative&&q.relative.destroy();var t={scaleLabel:{display:!0,labelString:"percent"},ticks:{max:100,steps:20,beginAtZero:!0}},n=D.default.getTotals(),a=e.map(function(e){var t=(0,x.default)(n),a=(0,A.default)({},e);return a.data=a.data.map(function(e,a){var r=t[a],u=e/n[r]*100;return u=u.toFixed(2),parseInt(u,10)}),a});q.relative=D.default.drawLineChart(S,a,t)}function y(e){q["relative-cumulative"]&&q["relative-cumulative"].destroy();var t={stacked:!0,scaleLabel:{display:!0,labelString:"percent"},ticks:{beginAtZero:!0}},n=D.default.getTotals(),a=e.map(function(e){var t=(0,x.default)(n),a=(0,A.default)({},e);return a.fill=!0,a.data=a.data.map(function(e,a){var r=t[a],u=e/n[r]*100;return u=u.toFixed(2),parseInt(u,10)}),a});q["relative-cumulative"]=D.default.drawLineChart(_,a,t)}function b(e){q.episodes&&q.episodes.destroy();var t=e.map(function(e){return e.tv}),n={scaleLabel:{display:!0,labelString:"avg. episode count"},ticks:{beginAtZero:!0}},a=D.default.getEpisodeTotals().tv;t=[{label:"overall",data:(0,x.default)(a).map(function(e){return a[e]}),fill:!1}].concat(t||[]),q.episodes=D.default.drawLineChart(B,t,n)}function m(e,t){return D.default.DB.getGenreData(e).then(function(n){var a=n.rows.filter(function(e){return e.value>=T}),r=D.default.generateColors(a.length,"genre-data-"+e);a=a.map(function(e,t){return e.color=r[t],e}),t.querySelectorAll(".js-values")[0].innerHTML=a.map(h).join("\n")})}function h(e){return'<label for="entry_'+e.key+'" class="pure-checkbox"><input type="checkbox" value="'+e.key+'" data-color="'+e.color+'" id="entry_'+e.key+'" />'+e.key+"</label>"}function g(){D.default.setupDownloads(),I.removeAttribute("disabled"),Z.removeAttribute("disabled"),u()}var k=n(17),A=a(k),w=n(23),x=a(w),L=n(24),C=a(L),E=n(36),D=a(E),T=25,j=void 0,S=void 0,_=void 0,B=void 0,I=void 0,Z=void 0,q={absolute:null,relative:null,"relative-cumulative":null,episodes:null};!function(){j=D.default.printChart("absolute","# of shows per year"),S=D.default.printChart("relative","% of shows per year"),_=D.default.printChart("relative-cumulative","% of shows per year (cumulative)"),B=D.default.printChart("episodes","Avg. # of Eps per year (TV)"),I=document.getElementById("genres"),Z=document.getElementById("themes"),I.addEventListener("change",r),Z.addEventListener("change",r),C.default.all([D.default.init(),m("genres",I),m("themes",Z)]).then(g)}()}},[174])});
//# sourceMappingURL=index.js.map